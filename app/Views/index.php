<?= $this->extend('template') ?>
<?= $this->section('meta') ?>
<title>Sistem Pendaftaran Pelatihan dan Kuesioner Tracer study</title>
<?= $this->endSection() ?>
<!-- STYLESHEET  -->
<?= $this->section('stylesheet') ?>
<?= $this->endSection() ?>
<!-- MAIN CONTENT -->
<?= $this->section('content') ?>
<div class="site-blocks-cover overlay" style="background-image: url(public/assets/images/banner/banner.png);" data-aos="fade">
    <div class="container">
        <div class="row align-items-center justify-content-center">
            <div class="col-md-12" data-aos="fade-up" data-aos-delay="400">
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h1>Sistem Pendaftaran Pelatihan dan Kuesioner Tracer study</h1>
                        <p class="mb-5">Lorem ipsum dolor sit amet consectetur adipisicing elit. Laboriosam assumenda ea quo cupiditate facere deleniti fuga officia.</p>
                        <div>
                            <a  href="<?php echo site_url('kuesioner'); ?>" class="btn btn-primary mr-2 mb-2">Mulai Kuesioner</a>
                            <a href="javascript:;" onclick="modalPersonal()" class="btn btn-primary mr-2 mb-2">Pendaftaran Pelatihan</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="site-section" id="about-section">
    <div class="container">
        <div class="row align-items-lg-center">
            <div class="col-md-5 mb-5 mb-lg-0 position-relative">
                <img style="width: 80%;" src="<?= base_url(); ?>/public/assets/images/about_us.png" class="img-fluid" alt="Image" />
                <div class="experience">
                    <span class="year">STIMATA</span>
                    <span class="caption">Tracer Study</span>
                </div>
            </div>
            <div class="col-md-6 ml-auto">
                <h3 class="section-sub-title">Tentang Kami</h3>
                <h2 class="section-title mb-3">Selamat Datang</h2>
                <p class="mb-4">
                    Dalam rangka peningkatan kualitas Perguruan Tinggi dan terkait pengukuran Indikator Kinerja
                    Utama (IKU) 1 Perguruan Tinggi (PT) sesuai Keputusan Menteri Pendidikan dan Kebudayaan No.
                    754 Tahun 2020 , dengan hormat kami sampaikan agar Pimpinan Perguruan Tinggi dapat melaporkan
                    hasil pelacakan jejak alumni (Tracer Study) dengan ketentuan sebagai berikut:<br><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. Pelaporan dilakukan oleh operator perguruan tinggi melalui laman:
                    <a href="http://tracerstudy.kemdikbud.go.id" target="_blank">http://tracerstudy.kemdikbud.go.id</a><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. Hasil yang dilaporkan adalah pelacakan jejak alumni (Tracer Study) untuk lulusan tahun
                    <?= date('Y'); ?> yang dilaksanakan secara mandiri oleh perguruan tinggi<br><br>
                    Pelaksanaan tracer study dilaporkan sesuai dengan pelaporan indikator kinerja PT dan kementerian
                    dalam 4 (empat) triwulan yaitu periode Maret, Juni, September dan Desember

                </p>
            </div>
        </div>
    </div>
</div>

<section class="site-section">
    <div class="container">
        <div class="row mb-5">
            <div class="col-12">
                <h3 class="section-sub-title">How it works</h3>
                <h2 class="section-title mb-3">How It Works</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 col-lg-4">
                <div class="box-with-humber">
                    <h2 class="text-black">Innovate</h2>
                    <p class="mb-4">Lorem ipsum dolor sit amet consectetur adipisicing elit. Et praesentium eos nulla qui commodi consectetur beatae fugiat. Veniam iste rerum perferendis.</p>
                    <ul class="list-unstyled ul-check primary">
                        <li>Lorem ipsum dolor sit amet.</li>
                        <li>Lorem ipsum dolor sit amet.</li>
                        <li>Lorem ipsum dolor sit amet.</li>
                    </ul>
                </div>
            </div>

            <div class="col-md-6 col-lg-4">
                <div class="box-with-humber">
                    <h2 class="text-black">Create</h2>
                    <p class="mb-4">Lorem ipsum dolor sit amet consectetur adipisicing elit. Et praesentium eos nulla qui commodi consectetur beatae fugiat. Veniam iste rerum perferendis.</p>
                    <ul class="list-unstyled ul-check primary">
                        <li>Lorem ipsum dolor sit amet.</li>
                        <li>Lorem ipsum dolor sit amet.</li>
                        <li>Lorem ipsum dolor sit amet.</li>
                    </ul>
                </div>
            </div>

            <div class="col-md-6 col-lg-4">
                <div class="box-with-humber">
                    <h2 class="text-black">Scale</h2>
                    <p class="mb-4">Lorem ipsum dolor sit amet consectetur adipisicing elit. Et praesentium eos nulla qui commodi consectetur beatae fugiat. Veniam iste rerum perferendis.</p>
                    <ul class="list-unstyled ul-check primary">
                        <li>Lorem ipsum dolor sit amet.</li>
                        <li>Lorem ipsum dolor sit amet.</li>
                        <li>Lorem ipsum dolor sit amet.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="site-section" id="about-section">
    <div class="container">
        <div class="row mb-5">
            <div class="col-md-5 ml-auto mb-5 order-md-2" data-aos="fade">
                <img src="<?= base_url(); ?>/public/assets/images/about_1.jpg" alt="Image" class="img-fluid rounded" />
            </div>
            <div class="col-md-6 order-md-1" data-aos="fade">
                <div class="row">
                    <div class="col-12 mb-4">
                        <p class="lead">
                            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Eveniet incidunt magnam corrupti, odit eos harum quaerat nostrum voluptatibus aspernatur eligendi accusantium cum, impedit blanditiis voluptate commodi
                            doloribus, nemo dignissimos recusandae.
                        </p>
                    </div>
                    <div class="col-md-12 mb-md-5 mb-0 col-lg-6">
                        <div class="unit-4">
                            <div class="unit-4-icon mr-4 mb-3"><span class="text-primary icon-adb"></span></div>
                            <div>
                                <h3>Web &amp; Mobile Specialties</h3>
                                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Perferendis quis consect.</p>
                                <p class="mb-0"><a href="#">Learn More</a></p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 mb-md-5 mb-0 col-lg-6">
                        <div class="unit-4">
                            <div class="unit-4-icon mr-4 mb-3"><span class="text-primary icon-assignment"></span></div>
                            <div>
                                <h3>Intuitive Thinkers</h3>
                                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Perferendis quis.</p>
                                <p class="mb-0"><a href="#">Learn More</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div class="modal" id="personalModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Form Pendaftaran</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="<?= base_url('prosesPersonal'); ?>" id="personal-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label>NIM</label>
                        <input type="text" class="form-control" required name="nim">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Lanjut</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal" id="trainingModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Form Pelatihan</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="<?= base_url('prosesTraining'); ?>" id="training-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label>Tanggal</label>
                        <input type="date" class="form-control" required name="date">
                    </div>
                    <div class="form-group">
                        <label>Waktu</label>
                        <input type="time" class="form-control" required name="time">
                    </div>
                    <div class="form-group">
                        <label>Pelatihan</label>
                        <select class="form-control" name="training" required="">
                            <option value="">Pilih Pelatihan</option>
                            <option value="Kotlin">Kotlin</option>
                            <option value="Data Expet Training dan Sertifikasi">Data Expet Training dan Sertifikasi</option>
                            <option value="Pluther Fundelmental">Pluther Fundelmental</option>
                            <option value="Falebuks ADS">Falebuks ADS</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Deskripsi Pelatihan</label>
                        <textarea name="description" style="height: 150px;" class="form-control" required=""></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Lanjut</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Tutup</button>
                </div>
            </form>
        </div>
    </div>
</div>

<?= $this->endSection() ?>

<!-- JAVASCRIPT  -->
<?= $this->section('javascript') ?>
<?php 
    $sessionData = \Config\Services::session();
    $sessionData->start();
?>
<?php if (@$sessionData->getFlashdata('msg_code')) { ?>
    <script type="text/javascript">
        toastr.error($sessionData->getFlashdata('msg_code'), 'Maaf!');
    </script>
<?php } ?>
<script type="text/javascript">
    function modalPersonal() {
        $('#personalModal').modal('show');
    }

    $('#personal-form').on('submit', function(event) {
        event.preventDefault();
        $.LoadingOverlay('show');
        $.ajax({
            url: $('#personal-form').attr('action'),
            method: 'POST',
            data: $('#personal-form').serialize(),
            dataType: 'json',
        }).done(function(data, textStatus, jqXHR) {

            $.LoadingOverlay('hide');
            $('#personalModal').modal('hide');
            $('#trainingModal').modal('show');

        }).fail(function(jqXHR, textStatus, errorThrown) {
            $.LoadingOverlay('hide');
            msg = jqXHR?.responseJSON?.messages?.error ? jqXHR.responseJSON.messages.error : errorThrown;
            if(jqXHR.status == '500'){

                toastr.error(msg, 'Maaf!');
            }else if(jqXHR.status == '401')
            {
                toastr.error('NIM tidak ditemukan', 'Maaf!');
            }

        }).always(function() {
        });
    });

    $('#training-form').on('submit', function(event) {
        event.preventDefault();
        $.LoadingOverlay('show');
        $.ajax({
            url: $('#training-form').attr('action'),
            method: 'POST',
            data: $('#training-form').serialize(),
            dataType: 'json',
        }).done(function(data, textStatus, jqXHR) {
            $.LoadingOverlay('hide');
            $('#trainingModal').modal('hide');
            alert('Insert Data Sukses');
            // window.location.href = "<?= base_url('kuesioner'); ?>"
        }).fail(function(jqXHR, textStatus, errorThrown) {
            $.LoadingOverlay('hide');
            msg = jqXHR?.responseJSON?.messages?.error ? jqXHR.responseJSON.messages.error : errorThrown;
            toastr.error(msg, 'Maaf!');
        }).always(function() {
        });
    });
</script>
<?= $this->endSection() ?>